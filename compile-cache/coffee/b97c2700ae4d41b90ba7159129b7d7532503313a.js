(function() {
  ex.Orbitable = (function() {
    function Orbitable(lat, lng, lngVelocity, latVelocity, altitude) {
      this.lat = lat != null ? lat : 0;
      this.lng = lng != null ? lng : 0;
      this.lngVelocity = lngVelocity != null ? lngVelocity : 0;
      this.latVelocity = latVelocity != null ? latVelocity : 0;
      this.altitude = altitude != null ? altitude : 0;
    }

    Orbitable.prototype.build = function() {
      this.node = document.createElement('div');
      this.shadowNode = document.createElement('div');
      this.node.className = this.getClassName();
      this.shadowNode.className = 'shadow';
      return [this.node, this.shadowNode];
    };

    Orbitable.prototype.getClassName = function() {
      return 'cloud';
    };

    Orbitable.prototype.animate = function(t) {
      var dist, front, rotate, x, xShadow, y, yShadow, zindex, _ref;
      this.lng += this.lngVelocity * t;
      this.lat += this.latVelocity * t;
      if (this.lng > 180) {
        this.lng = -180;
      }
      if (this.lng < -180) {
        this.lng = 180;
      }
      if (this.lat > 180) {
        this.lat = -180;
      }
      if (this.lat < -180) {
        this.lat = 180;
      }
      x = Math.sin(ex.deg2rad(this.lat)) * (128 + this.altitude) * Math.abs(Math.sin(ex.deg2rad(90 + this.lng)));
      y = Math.cos(ex.deg2rad(90 + this.lng)) * (128 + this.altitude);
      xShadow = Math.sin(ex.deg2rad(this.lat)) * 128 * Math.abs(Math.sin(ex.deg2rad(90 + this.lng)));
      yShadow = Math.cos(ex.deg2rad(90 + this.lng)) * 128;
      dist = Math.max(Math.sqrt(x * x + y * y) - this.altitude, 0);
      rotate = Math.atan2(y, x);
      front = (90 >= (_ref = this.lat) && _ref >= -90);
      zindex = front ? 10 + Math.round(128 - dist) : 0;
      this.node.setAttribute('style', ("top: " + (128 + y) + "px;\nleft: " + (128 + x) + "px;\nz-index: " + zindex + ";\n" + (this.getStyle(front, x, y, rotate, dist))).replace(/\s+/g, ' '));
      return this.shadowNode.setAttribute('style', ("top: " + (128 + yShadow) + "px;\nleft: " + (128 + xShadow) + "px;\nz-index: " + (front ? 1 : -1) + ";\n" + (this.getShadowStyle(front, x, y, rotate, dist))).replace(/\s+/g, ' '));
    };

    return Orbitable;

  })();

}).call(this);

//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAiZmlsZSI6ICIiLAogICJzb3VyY2VSb290IjogIiIsCiAgInNvdXJjZXMiOiBbCiAgICAiL2hvbWUvY2hhbXAvLmF0b20vcGFja2FnZXMvbGluZS1jb3VudC90ZXN0L2V4b3BsYW5ldHMvYXBwL2Fzc2V0cy9qYXZhc2NyaXB0cy9wbGFuZXRzL29yYml0YWJsZS5qcy5jb2ZmZWUiCiAgXSwKICAibmFtZXMiOiBbXSwKICAibWFwcGluZ3MiOiAiQUFBQTtBQUFBLEVBQU0sRUFBRSxDQUFDO0FBQ00sSUFBQSxtQkFBRSxHQUFGLEVBQ0UsR0FERixFQUVFLFdBRkYsRUFHRSxXQUhGLEVBSUUsUUFKRixHQUFBO0FBSWUsTUFKZCxJQUFDLENBQUEsb0JBQUEsTUFBSSxDQUlTLENBQUE7QUFBQSxNQUhkLElBQUMsQ0FBQSxvQkFBQSxNQUFJLENBR1MsQ0FBQTtBQUFBLE1BRmQsSUFBQyxDQUFBLG9DQUFBLGNBQVksQ0FFQyxDQUFBO0FBQUEsTUFEZCxJQUFDLENBQUEsb0NBQUEsY0FBWSxDQUNDLENBQUE7QUFBQSxNQUFkLElBQUMsQ0FBQSw4QkFBQSxXQUFTLENBQUksQ0FKZjtJQUFBLENBQWI7O0FBQUEsd0JBTUEsS0FBQSxHQUFPLFNBQUEsR0FBQTtBQUNMLE1BQUEsSUFBQyxDQUFBLElBQUQsR0FBUSxRQUFRLENBQUMsYUFBVCxDQUF1QixLQUF2QixDQUFSLENBQUE7QUFBQSxNQUNBLElBQUMsQ0FBQSxVQUFELEdBQWMsUUFBUSxDQUFDLGFBQVQsQ0FBdUIsS0FBdkIsQ0FEZCxDQUFBO0FBQUEsTUFHQSxJQUFDLENBQUEsSUFBSSxDQUFDLFNBQU4sR0FBa0IsSUFBQyxDQUFBLFlBQUQsQ0FBQSxDQUhsQixDQUFBO0FBQUEsTUFJQSxJQUFDLENBQUEsVUFBVSxDQUFDLFNBQVosR0FBd0IsUUFKeEIsQ0FBQTthQU1BLENBQUMsSUFBQyxDQUFBLElBQUYsRUFBUSxJQUFDLENBQUEsVUFBVCxFQVBLO0lBQUEsQ0FOUCxDQUFBOztBQUFBLHdCQWVBLFlBQUEsR0FBYyxTQUFB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

//# sourceURL=/home/champ/.atom/packages/line-count/test/exoplanets/app/assets/javascripts/planets/orbitable.js.coffee
